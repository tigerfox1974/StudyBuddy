---
description: "StudyBuddy – Dokümandan Sınav Modu – Project rules"
globs: "*"
alwaysApply: true
---

## Project Overview

- Project name: **StudyBuddy – Dokümandan Sınav Modu**
- Business goal (short): **Öğrencilerin PDF, Word, PowerPoint ve metin dosyalarındaki ders notlarını yükleyerek; bu dokümanlardan otomatik konu özeti, çoktan seçmeli sorular, kısa cevap soruları ve flashcard’lar üretmesini sağlamak. Bunu abonelik modeliyle para kazandıran, ölçeklenebilir bir web ürünü haline getirmek.**
- Target users: **Lise, üniversite ve sınavlara (YKS, KPSS vb.) hazırlanan öğrenciler; orta vadede etüt merkezleri ve özel ders veren öğretmenler.**
- Main platform(s): **Web uygulaması (masaüstü ve mobil tarayıcı üzerinden kullanılacak, ilk aşamada tek dil Türkçe, ileride çok dilliliğe açık).**
- Any hard constraints (if any): **Kullanıcı tarafında kurulum gerektirmeden tarayıcıdan çalışmalı; en azından PDF, DOCX, PPTX ve TXT dosya türlerini desteklemeli; acemi kullanıcılar için basit, tek adımlı bir akışa sahip olmalı; ileride abonelik/ödeme entegrasyonuna uygun tasarlanmalı.**

> Kullanıcı acemi bir programcıdır ve genellikle sadece bu bölümü düzenleyecektir.  
> Aşağıdaki teknik kararlar, bu overview ve global User Rules temel alınarak ajan tarafından otomatik uygulanmalıdır.

---

## How the Agent Should Interpret This File

- Bu dosya, StudyBuddy projesi için bir **mini “charter”** (proje sözleşmesi) olarak kabul edilmelidir.
- Bu Project Rules + global **User Rules** birlikte:
  - Uygun **teknoloji yığını**nı (stack),
  - Mantıklı bir **mimari ve klasör yapısı**nı,
  - Gerekirse **veritabanı yaklaşımını**,
  - **Test çerçevesi**ni,
  - Basit bir **DevOps / deployment** stratejisini
  seçmek için temel oluşturur.

- Ancak, **tek gerçek kaynak her zaman mevcut repository ve dosya yapısıdır**:
  - Mevcut klasörler, dosyalar ve kod blokları ile çelişen öneriler sadece “öneri” olarak sunulmalı,
  - Mevcut yapıyı yok sayan, sıfırdan bambaşka proje yapısı kuran veya her şeyi yeniden icat eden çözümler üretilmemelidir.

- Ajan aşağıdaki ilkelere uymalıdır:
  - **Önce oku, sonra dokun**: Önce mevcut dosya yapısını ve kodu analiz et, sonra değişiklik öner.
  - **Küçük, güvenli adımlar**: Büyük, kırıcı refactor yerine öncelik küçük ve anlaşılır değişikliklerdir.
  - **Açıkça belirt**: Yeni dosya, klasör, bağımlılık veya yapı öneriyorsan:
    - “Öneri” olduğunu açıkça yaz,
    - Tam yolunu ve sorumluluğunu 1–2 cümle ile açıkla.
  - Kullanıcı acemi olduğundan:
    - “Genel anlatım” yerine,
    - Dosya bazlı ve komut bazlı net adımlar verilmelidir (hangi dosyaya ne yapıştırılacağı, hangi komutun nerede çalıştırılacağı gibi).

---

## Technology Stack (Bu proje için SEÇİLMİŞ ve SABİT)

Bu proje özelinde teknoloji yığını şudur ve ajan bu stack’ten keyfine göre sapmamalıdır:

- Backend:
  - **Python 3 + Flask** tabanlı web uygulaması.
- AI entegrasyonu:
  - **OpenAI API** (model seçimi ajan tarafından belirlenebilir, maliyet / kalite dengesi gözetilerek).
  - API anahtarı backend tarafında, ortam değişkeni veya konfig dosyası ile yönetilecek (asla frontend’e sızmayacak).
- Doküman okuma (metne dönüştürme):
  - PDF: `pypdf` veya `pdfplumber`
  - Word (.docx): `python-docx`
  - PowerPoint (.pptx): `python-pptx`
  - Düz metin (.txt): standart dosya okuma
- Arayüz:
  - **Basit HTML + Bootstrap** (responsive, mobil uyumlu).
- Veritabanı:
  - MVP aşamasında zorunlu değil; tüm işlemler tek oturumda yürütülebilir.
  - İleride kullanıcı kaydı / abonelik / kullanım log’ları için **SQLite + basit ORM (ör. SQLAlchemy)** tercih edilecektir.
- Ortam:
  - Geliştirme ortamı: Windows, VS Code.
  - Deployment için ileride basit bir Linux sunucu veya PaaS (Render, Railway, Azure Web App vb.) hedeflenebilir.

Ajan:
- Bu stack dışında yeni framework, dil veya büyük teknoloji değişikliği ÖNERMEK isterse, bunu sadece:
  - “Alternatif öneri” olarak,
  - Gerekçe ile ve
  - “Uygulamadım, sadece öneriyorum” notu ile sunmalıdır.
- Varsayılan davranış: **mevcut stack üzerinde, mevcut kodu bozmadan ilerlemek** olmalıdır.

---

## Architecture & Folder Structure (StudyBuddy için)

- Varsayılan yaklaşım:
  - **Basit, modüler monolith** Flask uygulaması.

- Önerilen klasör yapısı (yeni bir proje başlatılıyorsa veya mevcut yapı buna yakınsa):

  - Proje kök dizini:
    - `app.py` → Flask giriş noktası, route tanımları
    - `config.py` → Konfigürasyon (OpenAI API key, temel ayarlar)
    - `requirements.txt` → Python bağımlılıkları
    - `services/`
      - `pdf_reader.py` → Dokümanlardan metin çıkarma fonksiyonları
      - `ai_questions.py` → OpenAI ile özet, sorular ve flashcard üreten fonksiyonlar
    - `templates/`
      - `index.html` → Dosya yükleme formu, temel ana sayfa
      - `result.html` → Özet, test soruları, kısa cevap soruları, flashcard listesi
    - `static/`
      - `css/` (gerekirse özel stiller)
      - `js/` (gerekirse küçük JS fonksiyonları)
    - `uploads/` → Yüklenen dokümanların geçici tutulduğu klasör (gerekirse `.gitignore`’a alınacak)

- Ajan için kurallar:
  - Yeni dosya/klasör eklerken:
    - Tam yolu belirtilmeli,
    - Sorumluluğu 1–2 cümleyle özetlenmelidir.
  - Mevcut repo yapısı bu ideal yapıdan farklıysa:
    - Öncelik mevcut yapıya uyum sağlamak,
    - “Tüm yapıyı baştan bu şemaya göre kurdum” dememek,
    - Gerekirse bu yapıyı sadece “gelecek refactor önerisi” olarak sunmaktır.

---

## UX & UI Principles (Genel)

Ajan, StudyBuddy arayüzüyle ilgili çalışırken şu kurallara uymalıdır:

- **Genel yaklaşım**
  - Arayüz: sade, modern, güven veren, “öğrenci dostu” görünmelidir.
  - Öncelik: **kullanılabilirlik > estetik**, ancak estetik de ihmal edilmemelidir.

- **Ana akış (happy path)**
  1. Dosya yükle (PDF/DOCX/PPTX/TXT)
  2. İşleme süreci (yükleniyor / analiz ediliyor göstergeleri)
  3. Sonuç ekranı:
     - Özet
     - Çoktan seçmeli sorular
     - Kısa cevap soruları
     - Flashcard’lar
  4. Tek tıkla:
     - Soruları kopyala/indir,
     - Yeni doküman yüklemeye dön.

- **Ekran tasarımı**
  - Her sayfada **tek ana amaç** olmalı (ör. “Doküman yükle” ekranında sadece yükleme ve ayarlar).
  - Bölümleri kartlar halinde grupla:
    - “Doküman Özeti”
    - “Çoktan Seçmeli Sorular”
    - “Kısa Cevap Soruları”
    - “Flashcard Seti”
  - Tutarlı spacing (4/8/12/16/24 px) kullan.
  - Form elemanları hizalı ve etiketleri net olmalı.

---

## StudyBuddy – UI Design System & Visual Guidelines

You must treat this section as the **single source of truth** for branding, colors, typography, spacing, and core UI components of the StudyBuddy product.

StudyBuddy is:
- A serious yet friendly study assistant,
- Targeting teenagers, university students and exam candidates,
- Educational, calm, trustworthy, not childish.

All visual decisions MUST respect the rules below.

### 1. Branding & Logo

**Brand name:** StudyBuddy  
**Default tagline (optional):** “Notlarını sınava dönüştür.” (Turkish) / “Turn your notes into exams.” (English)

#### 1.1 Logo concept

- The logo consists of:
  - A simple **icon** + the **wordmark “StudyBuddy”**.
- Icon concept (do NOT overcomplicate):
  - A rounded square or circle with:
    - A stylized open book or a minimal “SB” monogram,
    - Background: Primary color `#2563EB`,
    - Foreground (icon or SB letters): white `#FFFFFF`.
- Wordmark:
  - Font: same as UI headings (see Typography),
  - Weight: semi-bold,
  - Color: `#0F172A` on light backgrounds, `#FFFFFF` on primary-colored navbars.

#### 1.2 Logo usage rules

- Clear space:
  - Keep at least **0.5× logo height** empty space around the logo (no other elements inside this zone).
- Minimum size:
  - Screen: do not render the logo smaller than **24 px height**.
- Light background usage:
  - Icon: primary background `#2563EB`, icon/letters white.
  - Wordmark: `#0F172A`.
- Dark / primary background usage (e.g. navbar):
  - Icon: white background with primary-colored icon/letters or keep primary icon but add subtle white outline.
  - Wordmark: white `#FFFFFF`.
- Do NOT:
  - Add gradients or random colors,
  - Add heavy shadows or glows,
  - Stretch, distort, or rotate the logo.

---

### 2. Color System

Use the following color tokens for all UI design and implementation.

#### 2.1 Core colors

- `--sb-color-primary:   #2563EB;`  // main brand blue (trust, focus)
- `--sb-color-secondary: #22C55E;`  // success / learning / “done”
- `--sb-color-accent:    #FACC15;`  // highlight / “new” / attention

#### 2.2 Neutrals

- `--sb-color-bg:          #F9FAFB;` // main app background
- `--sb-color-surface:     #FFFFFF;` // cards, panels, modals
- `--sb-color-border:      #E5E7EB;` // dividers, card borders
- `--sb-color-text-main:   #0F172A;` // main dark text
- `--sb-color-text-muted:  #6B7280;` // secondary text, hints

#### 2.3 Semantic states

- `--sb-color-success: #22C55E;`
- `--sb-color-warning: #F97316;`
- `--sb-color-error:   #EF4444;`
- `--sb-color-info:    #38BDF8;`

Rules:
- Use **primary** for main actions and key highlights.
- Use **secondary** mainly for success messages, completion badges and positive states.
- Use **accent** for small attention grabbers (badges, “new” labels), not as full background.
- Keep backgrounds light and minimal; avoid dark mode unless explicitly required by the user.

---

### 3. Typography

Use a clean sans-serif font family:

- Primary font: `Inter`, `Roboto` or `Nunito` (or system equivalent).
- Fallback: `system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`.

Text styles (web scale):

- `Display / Page Title`  
  - Size: 32 px  
  - Weight: 700  
  - Color: `#0F172A`
- `Section Title`  
  - Size: 24 px  
  - Weight: 600  
  - Color: `#0F172A`
- `Card Title / Subheading`  
  - Size: 18–20 px  
  - Weight: 600  
  - Color: `#0F172A`
- `Body Text`  
  - Size: 14–16 px  
  - Weight: 400  
  - Color: `#0F172A`
- `Muted / Helper Text`  
  - Size: 12–14 px  
  - Weight: 400  
  - Color: `#6B7280`
- `Caption / Small Label`  
  - Size: 12 px  
  - Weight: 500  
  - Color: `#6B7280`

Rules:
- Keep **page title** at the top of each main view.
- Use **Section Titles** to separate “Doküman Özeti”, “Çoktan Seçmeli Sorular”, “Kısa Cevap Soruları”, “Flashcard Seti”.
- Do not use more than 3–4 different font sizes on a single screen.

---

### 4. Spacing, Radius & Shadows

#### 4.1 Spacing scale

Use a simple 4 px spacing grid:

- `4, 8, 12, 16, 24, 32 px`

Examples:
- Card padding: `16–24 px`
- Vertical spacing between sections: `24–32 px`
- Spacing between label and input: `4–8 px`
- Spacing between form fields: `12–16 px`

#### 4.2 Corners

- Default border radius for cards, inputs, buttons: **8–12 px**.
- Modals and big surfaces may use **12–16 px** for a softer feel.
- Avoid sharp 0 px corners except for very small UI elements.

#### 4.3 Shadows

- Use subtle shadows to give depth without looking noisy:
  - Example: `0 1px 2px rgba(15, 23, 42, 0.06)` for small elements,
  - Example: `0 4px 12px rgba(15, 23, 42, 0.08)` for modals/large cards.
- Do not stack multiple heavy shadows.

---

### 5. Layout & Page Structure

General rules for StudyBuddy screens:

- App background: `--sb-color-bg` (`#F9FAFB`).
- Content container:
  - Max width: ~`1100–1200 px`,
  - Centered with horizontal padding (`16–24 px`).
- Main layout blocks:
  1. Top navigation bar,
  2. Page title + optional breadcrumbs,
  3. Main content cards (upload form, results, etc).

Use a **single primary flow** per page:
- Upload page: focus on “Dosya Yükle + Ayarları Seç + İşleme Başlat”.
- Results page: focus on “Üretilen içeriği gör, kopyala, dışa aktar, yeni doküman yükle”.

---

### 6. Navigation Bar

- Height: `56–64 px`.
- Background: `--sb-color-primary` (`#2563EB`).
- Contents:
  - Left: Logo (icon + “StudyBuddy” wordmark).
  - Right: Minimal navigation (e.g., “Ana Sayfa”, “Hakkında”, “Destek”) and primary CTA if needed.
- Text:
  - Color: `#FFFFFF`.
  - Active link: underline or bottom border in `#FACC15` (accent) or a lighter shade.

---

### 7. Buttons

Define three main button types: **Primary**, **Secondary**, **Tertiary**.

#### 7.1 Primary Button (Main CTA)

- Usage:
  - Main actions like “Sınavı Oluştur”, “Soruları Üret”, “Yeni Doküman Yükle”.
- Style:
  - Background: `#2563EB`
  - Text color: `#FFFFFF`
  - Border: none or same color as background
  - Radius: `8–9999 px` (slightly rounded or pill-shaped)
  - Padding:
    - Vertical: `8–12 px`
    - Horizontal: `16–20 px`
  - Font: `14–16 px`, weight `600`.

- States:
  - Hover: slightly darker blue (e.g. `#1D4ED8`), subtle shadow.
  - Active: `#1E40AF`, shadow reduced.
  - Disabled:
    - Background: `#93C5FD`,
    - Text: `#E5E7EB`,
    - No shadow.

#### 7.2 Secondary Button

- Usage:
  - Less critical actions: “Geri dön”, “İptal et”, “Filtrele”, “Farklı seçenekler”.
- Style:
  - Background: `#FFFFFF`
  - Border: `1 px solid #2563EB`
  - Text: `#2563EB`
  - Radius, padding, font: same as Primary.

- States:
  - Hover: light blue background tint (`#EFF6FF`),
  - Active: slightly darker border and text (`#1D4ED8`).

#### 7.3 Tertiary Button / Text Button

- Usage:
  - Very light actions like “Daha fazla oku”, “Ayrıntılar”.
- Style:
  - No background,
  - No border or very subtle underline on hover.
  - Text color: `#2563EB`.
  - Keep hover state visible (underline or color darkening).

---

### 8. Cards & Content Sections

Cards are the core building blocks of StudyBuddy screens.

Use cards for:

- “Doküman Özeti”
- “Çoktan Seçmeli Sorular”
- “Kısa Cevap Soruları”
- “Flashcard Seti”
- “İşlem Durumu / Geçmiş Çalışmalar” (future)

#### Card style

- Background: `#FFFFFF`
- Border: `1 px solid #E5E7EB` or none with light shadow
- Shadow: `0 1px 2px rgba(15, 23, 42, 0.06)`
- Radius: `12 px`
- Padding: `16–24 px`
- Layout:
  - Header:
    - Title (Section Title style),
    - Optional small badge (e.g. “Yeni”, “Oluşturuldu”).
  - Body:
    - Text, lists, question items, etc.
  - Footer (optional):
    - Small actions (e.g. “Hepsini kopyala”, “PDF Olarak Dışa Aktar”).

#### Card header accent

- Add a thin top border or small left accent bar:
  - Summary card → `#2563EB`
  - Questions card → `#22C55E`
  - Flashcards card → `#FACC15`

---

### 9. Forms & Inputs

Forms (file upload, options selection, filters) must be **simple and clear**.

#### Input style

- Background: `#FFFFFF`
- Border: `1 px solid #D1D5DB`
- Radius: `8 px`
- Padding: `8–10 px` vertical, `10–12 px` horizontal
- Text: `#0F172A`
- Placeholder: `#9CA3AF`

#### States

- Focus:
  - Border: `2 px solid #2563EB`
  - Optional subtle shadow: `0 0 0 1px rgba(37, 99, 235, 0.3)`
- Error:
  - Border: `1 px solid #EF4444`
  - Helper text below in `#EF4444`
- Disabled:
  - Background: `#F3F4F6`
  - Text: `#9CA3AF`
  - No strong shadow.

#### Labels & helper text

- Label:
  - Above the input,
  - Text: `#0F172A`, 14 px, medium weight.
- Helper text:
  - Below the input (optional),
  - `#6B7280`, 12–13 px.

#### File upload area

- Use a **card-like dropzone**:
  - Dashed border: `#93C5FD` or `#CBD5F5`,
  - Icon (cloud upload or file icon) in primary color,
  - Short instruction text: “PDF, DOCX, PPTX veya TXT yükleyin” (Turkish default),
  - Small hint: “Maksimum boyut: X MB”.

---

### 10. Tables & Lists (for Questions / Results)

When displaying generated questions or flashcards:

- Use either:
  - Simple list groups (for small datasets), or
  - A light table (for many questions).

Basic table style:

- Header row:
  - Background: `#F3F4F6`,
  - Text: `#0F172A`, slightly bolder.
- Rows:
  - Alternating background: `#FFFFFF` / `#F9FAFB` is allowed.
  - Row hover: subtle background tint `#EFF6FF`.
- Borders:
  - Vertical separation can be minimal; horizontal lines in `#E5E7EB`.

---

### 11. Feedback Components (Alerts, Toasts, Loading)

#### Alerts / Banners

- Success:
  - Background: very light green (`#ECFDF3`),
  - Border-left: `#22C55E`,
  - Icon: checkmark in `#22C55E`,
  - Text: `#166534`.
- Error:
  - Background: `#FEF2F2`,
  - Border-left: `#EF4444`,
  - Icon: error in `#B91C1C`,
  - Text: `#B91C1C`.
- Info:
  - Background: `#EFF6FF`,
  - Border-left: `#2563EB`,
  - Text: `#1D4ED8`.

#### Toasts / Notifications

- Small, right-bottom or right-top,
- Card style with slight shadow,
- Short message + optional CTA.

#### Loading / Skeletons

- Use activity indicators while generating questions:
  - Simple spinner in primary color,
  - Optional “skeleton” placeholders for text blocks.
- Always show explicit text:
  - Example: “Sorular oluşturuluyor, lütfen bekleyin…”

---

### 12. Motion & Micro-interactions

- Use subtle animations:
  - Fade-in for cards when results are ready,
  - Slight scale or shadow change on button hover.
- Avoid:
  - Flashy bouncing, rotating or neon effects.
- Duration:
  - 150–250 ms for most interactions.
- Easing:
  - Standard ease-out for entering,
  - Ease-in for exiting.

---

### 13. Language & Content Tone

- Default UI language: **Turkish**.
- Tone:
  - Friendly but not childish,
  - Motivational but not cheesy,
  - Clear, short sentences.

Examples:
- Primary CTA: “Soruları Oluştur”
- Secondary CTA: “Yeni Doküman Yükle”
- Empty state:  
  - Title: “Henüz bir doküman yüklemediniz.”  
  - Text: “Başlamak için PDF, Word, PowerPoint veya metin dosyanızı seçin.”

---

## AI Behavior & Prompting Strategy (Özet, Soru, Flashcard)

Ajan, OpenAI ile çalışırken aşağıdaki davranış kurallarına uymalıdır:

- **Kaynak metne sadakat**
  - Üretilen özet, sorular ve flashcard’lar **YALNIZCA** kullanıcının sağladığı doküman içeriğine dayanmalıdır.
  - Dokümanda olmayan bilgi:
    - Eklenmemeli,
    - “Genel bilgi” gibi sunulmamalı,
    - Gerekirse “Bu kısım dokümanda yok, genel bilgi olarak ekliyorum” diye açıkça belirtilmelidir (tercihen hiç eklenmemeli).

- **Context yönetimi**
  - Uzun dokümanlarda:
    - Metin anlamlı parçalara (chunk’lara) bölünmeli,
    - Özetler parça parça alınmalı, sonra birleştirilmelidir.
  - Aynı anda çok büyük metin göndermekten kaçınılmalı (token optimizasyonu).

- **Özet oluşturma**
  - Özetler:
    - Kısa, net, madde madde olmalı,
    - Konu başlıklarını ve kritik kavramları vurgulamalıdır.
  - İstenen seviye:
    - Lise/üniversite öğrencisinin anlayacağı düzey,
    - Gereksiz akademik jargon yok.

- **Soru üretimi – Çoktan seçmeli**
  - Her soru:
    - Tek, net bir doğru cevaba sahip olmalı,
    - 4 seçenek (A–D) içermeli,
    - Seçenekler makul ve birbirine yakın zorlukta olmalı (biri çok saçma olmamalı).
  - Zorluk karışımı:
    - Kolay (tanım, doğrudan bilgi),
    - Orta (yorum, ilişkilendirme),
    - Zor (uygulama, kavramı yeni senaryoya taşıma).
  - Çıktı formatı:
    - Soru numarası,
    - Soru metni,
    - Şıklar,
    - Doğru cevabı gösteren answer key (örn. ayrı listede).

- **Soru üretimi – Kısa cevap**
  - “1–3 cümlelik” cevabı olan sorular üret.
  - Öğrenciyi:
    - Tanım yapmaya,
    - Karşılaştırma yapmaya,
    - Örnek vermeye zorlayan sorular tercih edilmelidir.

- **Flashcard üretimi**
  - Biçim:
    - `Ön yüz (Soru / Kavram)` – `Arka yüz (Cevap / Açıklama)`.
  - Kapsam:
    - Temel kavramlar,
    - Formüller,
    - Önemli tarih/olay/kişiler (ilgili ise),
    - Sık karıştırılan noktalar.

- **Dil & seviye**
  - Varsayılan dil: **Türkçe**.
  - Metin karmaşıksa, önce basitleştirilmiş versiyon (öğrenci dostu dil) önerilebilir.
  - İleride çok dillilik için:
    - Soru/flashcard çıktılarının dil parametresi ile üretilebileceği göz önünde bulundurulmalı.

---

## Database & Data Model (Yaklaşım)

- MVP:
  - Kullanıcı girişi / hesap sistemi yoksa:
    - Veritabanı zorunlu değil.
    - Kullanıcının yüklediği dosya ve AI çıktıları sadece bellek/oturum bazlı olabilir.
- İlerleyen fazlar:
  - Kullanıcı kaydı, abonelik ve kullanım log’ları eklenecekse:
    - Basit bir **SQLite** veritabanı tercih edilecektir.
    - Önerilen temel tablolar:
      - `users` → kullanıcı hesapları (email, şifre hash, abonelik planı vb.)
      - `documents` → yüklenen dokümanlar (kullanıcıya bağlı, dosya adı, türü, boyutu)
      - `jobs` → her “işleme” için kayıt (doc id, soru sayısı, süre, token tüketimi vb.)
  - ORM:
    - Tercihen **SQLAlchemy** kullanılacak,
    - Migration yönetimi için basit bir araç (ör. Alembic) değerlendirilebilir, ancak kullanıcı seviyesine göre adım adım açıklanacaktır.

---

## Quality, Error Handling & Logging

- **Hata yönetimi**
  - Kullanıcıya gösterilen hata mesajları:
    - Kısa, sade ve Türkçe olmalı,
    - İç detayları (stack trace vb.) içermemelidir.
  - Backend’te:
    - Hatalar log’lanmalı (dosya veya konsol),
    - Hata türü, endpoint, zaman damgası kaydedilmelidir.

- **Beklenen hata tipleri**
  - Desteklenmeyen dosya türü,
  - Aşırı büyük dosya,
  - Bozuk PDF/DOCX/PPTX,
  - OpenAI API hataları (rate limit, ağ hatası vb.).

- **Retry stratejisi (AI çağrıları için)**
  - API hatalarında:
    - 1–2 kez otomatik retry (küçük gecikme ile),
    - Sonrasında kullanıcıya düzgün hata mesajı.

- **Performans**
  - Gereksiz yere tüm dokümanı tekrar tekrar OpenAI’ye göndermekten kaçınılmalı.
  - Özet ve soru üretiminde:
    - Mümkünse aynı context’i yeniden kullanma (chunk bazlı yaklaşım).

---

## Testing Strategy (StudyBuddy için)

- Test framework:
  - **pytest** (Python ekosisteminde basit ve yaygın).

- Test öncelikleri:
  - `services/pdf_reader.py`:
    - Farklı dosya türlerinden (küçük test PDF, DOCX, PPTX, TXT) metin çıkarma fonksiyonlarının doğru çalıştığının test edilmesi.
  - `services/ai_questions.py`:
    - Doğrudan OpenAI’ye bağlı kısımlar için tam unit test yerine:
      - Prompt formatlama fonksiyonları,
      - Çıktının yapısal doğruluğu (örneğin, her çoktan seçmeli soruda 4 seçenek olması, cevap alanının varlığı) test edilebilir.
  - `app.py`:
    - Flask test client ile basit entegrasyon testi:
      - `/` endpoint’inin 200 dönmesi,
      - `/process` için örnek bir dosya upload’ında başarılı response alınması.

- Kullanıcı için test komutu:
  - `pytest` komutu ile tüm testlerin çalıştırılabileceği şekilde yapılandırılmalıdır.

---

## DevOps & Running Locally (StudyBuddy için)

- Lokal çalıştırma adımları (Windows + VS Code varsayımı):

  1. Python 3 kurulmuş olmalı (3.10+ önerilir).
  2. Proje klasöründe sanal ortam oluştur:
     - `python -m venv .venv`
  3. Sanal ortamı aktif et:
     - `.\.venv\Scripts\activate`
  4. Bağımlılıkları kur:
     - `pip install -r requirements.txt`
  5. Gerekli ortam değişkenlerini ayarla (geliştirme için):
     - `OPENAI_API_KEY` → OpenAI API anahtarı
  6. Flask uygulamasını çalıştır:
     - `flask run`  
       veya  
     - `python app.py` (seçilen yapıya göre)

- Deployment (ileriki faz için öneri):

  - Basit bir **Dockerfile**:
    - Python base image,
    - `requirements.txt` install,
    - `flask run` veya WSGI sunucu (gunicorn) ile başlatma.
  - Küçük bir cloud servise (Render, Railway, Azure Web App vs.) deploy edilebilir.
  - Gizli bilgilerin (OpenAI key vb.) ortamlarda **environment variable** ile yönetilmesi zorunlu.

---

## Security & Privacy

- **Doküman güvenliği**
  - Kullanıcı dokümanları:
    - Gereksiz yere disk üzerinde uzun süre tutulmamalı,
    - Mümkünse işlem sonrası silinmelidir.
  - Yalnızca:
    - Dokümandan çıkarılan metin,
    - Özet ve soru üretimi için gereken minimum context
    OpenAI API’ye gönderilmelidir.

- **Gizli anahtarlar**
  - `OPENAI_API_KEY`:
    - Asla front-end’e sızmamalı,
    - Commit’lenmemeli,
    - Ortam değişkeni veya güvenli config dosyası ile yönetilmelidir.

- **Kullanıcı verisi**
  - E-posta, isim vb. kişisel bilgiler işlenecekse:
    - Minimum veri tutma ilkesi,
    - Basit veri silme mekanizması (hesap silme ile bağlantılı) planlanmalıdır.

---

## Documentation

- README içermesi gerekenler:
  - Proje özeti (StudyBuddy’nin ne yaptığı),
  - Teknoloji yığını (Python + Flask + OpenAI + belge okuma kütüphaneleri),
  - Kurulum adımları (sanal ortam, bağımlılıklar, ortam değişkenleri),
  - Çalıştırma komutları,
  - Temel kullanım senaryosu (dosya yükle → sonuçları gör).

- İleride:
  - `docs/` klasörü altında:
    - Mimari tasarım notları (servislerin sorumlulukları),
    - API dokümantasyonu (eğer REST endpoint’leri dışa açılırsa),
    - Kullanıcı kılavuzu (ekran ekran kısa açıklama) hazırlanabilir.

---

## Special Constraints For This Project

- Kullanıcı:
  - **Acemi programcıdır**,
  - Ağırlıklı olarak **Windows + VS Code / Visual Studio** kullanır.
- Bu nedenle:
  - Karmaşık microservice mimarilerinden, Kubernetes’ten ve ağır CI/CD düzenlerinden kaçınılmalıdır.
  - Kurulum adımları, komutlar ve dosya konumları **adım adım** ve net yazılmalıdır.
  - “Set up X” gibi belirsiz ifadeler yerine:
    - Hangi dosyanın açılacağı,
    - Hangi kodun nereye yapıştırılacağı,
    - Hangi komutun terminalde çalıştırılacağı,
    açık ve doğrudan belirtilmelidir.

---

## Preserve Existing Working Behavior (Very Important)

- This project is already **running and functional**, even if the UI is not perfect.
- Therefore, the agent MUST follow these rules:

1. Do NOT touch critical startup & config parts unless explicitly asked:
   - Do not change how `app.py` starts the app (Flask init, routes wiring),
   - Do not change environment variable usage (e.g. `OPENAI_API_KEY`),
   - Do not change WSGI / deployment configuration files.

2. Prefer ADDITIVE changes over destructive ones:
   - You may add new CSS classes, small helper functions, or new templates,
   - But do NOT delete or radically rewrite existing working code unless the user clearly requests a refactor.

3. UI-first approach:
   - When the user asks for “visual improvements” or “UI/UX refactor”, focus on:
     - HTML structure,
     - CSS / Bootstrap classes,
     - Template layout.
   - Do NOT modify backend logic, routes, or services unless:
     - There is a clear bug, and
     - The user agrees that the logic should change.

4. No renaming of files, routes, or core functions without permission:
   - Do not rename template files (e.g. `index.html`, `result.html`),
   - Do not rename Flask routes or main service functions,
   - Do not change URLs used by the frontend.
   - If you believe a rename is beneficial, propose it as a suggestion first and wait for explicit approval.

5. Always explain “What changed and why”:
   - For any non-trivial code change, include a short section:
     - “What changed and why (impact on existing behavior)”.
   - Clearly state if there is any risk that the current working behavior might be affected.

6. When in doubt, be conservative:
   - If you are not sure whether a visual change might break existing behavior,
   - First propose it in a high-level description or pseudo-diff,
   - Then wait for the user to confirm before giving full code.

---

## Hata, Varsayım ve Halüsinasyon Politikası (Çok Önemli)

Bu proje için ajan aşağıdaki KESİN kurallara uymalıdır:

1. Mevcut Kod ve Dosyalar Tek Gerçek Kaynak
   - Sadece gerçekten var olan:
     - Dosyalar,
     - Klasörler,
     - Fonksiyonlar,
     - Değişkenler
     üzerinden işlem yapılmalıdır.
   - Var olmayan dosya, endpoint, sınıf veya fonksiyon “varmış gibi” kullanılmamalıdır.
   - Eğer bir şeyden emin değilse:
     - “Bu dosya sizde yoksa oluşturmanız gerekir” gibi açık uyarı yazmalı,
     - Uyduruyormuş gibi davranmamalıdır.

2. Yeni Dosya / Klasör / Library Eklerken
   - Ajan, doğrudan “ekledim” demek yerine:
     - “Şu dosyayı oluşturmanızı öneriyorum: `services/xyz.py` – sorumluluğu şudur: …”
     - “`requirements.txt` içine şu satırı eklemenizi öneriyorum: `paket_adı==versiyon`”
       şeklinde net talimat vermelidir.
   - Kullanıcının izni veya talebi olmadan:
     - Stack’i değiştiren,
     - Bambaşka mimariye geçen,
     - Çok sayıda yeni bağımlılık ekleyen çözümler üretmemelidir.

3. Tahmini Hareket / Varsayım Sınırları
   - Ajan aşağıdaki üç alanda “makul varsayım” yapabilir:
     1. UI/UX metinleri (buton ismi, etiket vb.)  
     2. Küçük yardımcı fonksiyon isimleri (ör. `format_text`, `clean_content` gibi)  
     3. Dosya içi kod düzeni (aynı dosya içinde fonksiyon sırası gibi)

   - Bunun DIŞINDA:
     - İş kuralları,
     - API sözleşmeleri,
     - Veritabanı şeması,
     - Ödeme / abonelik akışı  
     konusunda **varsayım yapmamalı**, sadece:
       - “Şu şekilde olabilir, kesin değil” diye açık şekilde belirsizliği belirtmeli
       - Ya da kullanıcıdan onay / netleştirme istemelidir.

4. Küçük, Güvenli Adımlar Kuralı
   - Öncelik:
     - Bir ekranı / fonksiyonu küçük adımlarla düzeltmek,
     - Mevcut yapıyı anlamak,
     - Sonra sınırlı bir alanı iyileştirmektir.
   - “Tüm projeyi baştan yazalım” tarzı cevaplar bu proje için **kabul edilemez**.

5. Çıktı Biçimi
   - Kod verirken:
     - Tam, çalışabilir, kopyala-yapıştır formatında olmalıdır.
     - “...” ile kesilmiş pseudo-kod verilmemelidir.
   - Ne değiştiğini anlatırken:
     - Kısa bir “Neler değişti ve neden?” maddeli listesi eklenmelidir.
   - Hata ihtimali olan noktalarda:
     - “Şu kısımda hata alırsanız, muhtemel sebep X olur” gibi yönlendirici notlar yazmalıdır.
